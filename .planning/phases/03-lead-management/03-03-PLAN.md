# Plan 03-03: Twilio SMS Integration

**Phase:** 3 - Lead Management Enhancement
**Status:** PLANNED
**Estimated Complexity:** Medium

## Objective

Integrate Twilio for sending and receiving SMS messages with leads.

## Prerequisites

- Plan 03-01 complete (lead detail page)
- Twilio account with phone number
- Environment variables configured

## Implementation

### Components to Create

1. **SMSModal Component** (`components/admin/SMSModal.tsx`)
   - Message textarea (1600 char limit)
   - Template selection dropdown
   - Character counter
   - Send button with loading state

2. **SMS Templates** (database seeding)
   - Initial outreach
   - Follow-up reminder
   - Demo confirmation
   - Thank you message

### API Updates

**Update** `app/api/admin/leads/[id]/sms/route.ts`:
- Integrate Twilio SDK
- Send SMS via Twilio API
- Store Twilio message SID
- Handle delivery status

**Create** `app/api/webhooks/twilio/route.ts`:
- Receive delivery status updates
- Receive inbound SMS
- Update communication records

### Environment Variables

```env
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=
```

### Twilio Integration

```typescript
import twilio from 'twilio'

const client = twilio(accountSid, authToken)

const message = await client.messages.create({
  body: messageContent,
  to: lead.phone,
  from: process.env.TWILIO_PHONE_NUMBER,
  statusCallback: `${baseUrl}/api/webhooks/twilio`
})
```

## Verification

- [ ] SMS modal opens from lead detail
- [ ] Messages send successfully
- [ ] Delivery status updates received
- [ ] Inbound messages create communication records
- [ ] Templates populate correctly

## Dependencies

- Twilio SDK (`twilio`)
- Lead communication API
- Webhook security

---
*Created: 2025-01-15 | Phase 3: Lead Management Enhancement*
